#!/usr/bin/python

import GitSvnServer
import optparse


def main():
    parser = optparse.OptionParser()

    parser.add_option('-c', '--config', metavar='CONFIG', default=None,
                      help='Load configuration from CONFIG')

    parser.add_option('-i', '--ip', metavar='ADDRESS', default=None,
                      help='Bind to the specifed IP address (can be v6 if '
                      'supported by Python).  The default is all addresses.')

    parser.add_option('-p', '--port', metavar='PORT', default=3690, type='int',
                      help='Bind to the specified port number, instead of '
                      'the default SVN port.')

    parser.add_option('-f', '--foreground', default=False, action="store_true",
                      help='Run in the foreground instead of as a daemon.')

    parser.add_option('-d', '--debug', default=False, action="store_true",
                      help='Run in debug mode (implies --foreground).')

    parser.add_option('-l', '--log', default='svnserver.log',
                      help='File to log to if running as daemon.')

    options, args = parser.parse_args()

    GitSvnServer.config.load(options.config)

    server = GitSvnServer.SvnServer(log = options.log,
                                    ip = options.ip,
                                    port = options.port)
    server.start(foreground = options.foreground,
                 debug = options.debug)


if __name__ == "__main__":
    main()
